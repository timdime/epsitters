<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Babysitting Adventure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .game-container {
            max-width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .screen {
            display: none;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
        }

        /* Main Menu Styles */
        .main-menu {
            background: linear-gradient(45deg, #4facfe 0%, #00f2fe 100%);
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
        }

        .game-title {
            font-size: clamp(2rem, 8vw, 4rem);
            color: white;
            text-shadow: 3px 3px 0px #ff6b6b;
            margin-bottom: 30px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8787);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            min-width: 200px;
            font-family: inherit;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        /* Character Selection */
        .character-select {
            background: linear-gradient(45deg, #a8edea 0%, #fed6e3 100%);
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }

        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
            max-width: 600px;
        }

        .character-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
        }

        .character-card:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .character-card.selected {
            border-color: #ff6b6b;
            background: linear-gradient(45deg, #fff5f5, #fff);
        }

        .character-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
        }

        /* Game Screen */
        .game-screen {
            background: linear-gradient(45deg, #ffecd2 0%, #fcb69f 100%);
            padding: 10px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .game-info {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .info-item {
            background: #ff6b6b;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
        }

        .game-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .child-area {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 200px;
            position: relative;
        }

        .child-character {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffeaa7, #fab1a0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin-bottom: 15px;
            position: relative;
            animation: gentle-bounce 3s infinite;
        }

        @keyframes gentle-bounce {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .child-needs {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .need-indicator {
            background: #ddd;
            border-radius: 10px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .need-indicator.urgent {
            background: #ff6b6b;
            color: white;
            animation: pulse 1s infinite;
        }

        .need-indicator.satisfied {
            background: #00b894;
            color: white;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .task-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .task-btn {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            font-weight: bold;
        }

        .task-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(116, 185, 255, 0.4);
        }

        .task-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Mini-game Styles */
        .mini-game {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .mini-game.hidden {
            display: none;
        }

        .feeding-game {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .food-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 10px;
            max-width: 300px;
            margin-bottom: 20px;
        }

        .food-item {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, #ffeaa7, #fdcb6e);
            border: 2px solid transparent;
        }

        .food-item:hover {
            transform: scale(1.1);
            border-color: #ff6b6b;
        }

        .food-item.selected {
            background: linear-gradient(45deg, #00b894, #00cec9);
            transform: scale(1.1);
        }

        .drop-zone {
            width: 120px;
            height: 120px;
            border: 3px dashed #74b9ff;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #74b9ff;
            transition: all 0.3s ease;
        }

        .drop-zone.active {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.1);
        }

        /* Puzzle Game */
        .puzzle-game {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .puzzle-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            max-width: 200px;
            background: #ddd;
            padding: 10px;
            border-radius: 10px;
        }

        .puzzle-piece {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
            border: 2px solid white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .puzzle-piece:hover {
            transform: scale(1.05);
        }

        .puzzle-piece.empty {
            background: white;
            border: 2px dashed #ddd;
        }

        /* Catch Game */
        .catch-game {
            position: relative;
            height: 300px;
            background: linear-gradient(to bottom, #87CEEB, #98FB98);
            border-radius: 15px;
            overflow: hidden;
        }

        .catcher {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ff8787);
            border-radius: 10px;
            cursor: pointer;
            transition: left 0.1s ease;
        }

        .falling-toy {
            position: absolute;
            width: 30px;
            height: 30px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fall linear;
        }

        @keyframes fall {
            from { top: -30px; }
            to { top: 100%; }
        }

        /* Speech Bubble */
        .speech-bubble {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 10px 15px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 10;
            animation: fadeInOut 3s ease-in-out;
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 10px solid transparent;
            border-top-color: white;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
            20%, 80% { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
        }

        .modal h2 {
            color: #ff6b6b;
            margin-bottom: 20px;
        }

        .modal p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .close-btn {
            background: #ddd;
            color: #333;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            margin-top: 20px;
        }

        .close-btn:hover {
            background: #ccc;
        }

        /* Audio Controls */
        .audio-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .audio-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .audio-btn:hover {
            background: white;
            transform: scale(1.1);
        }

        .audio-btn.muted {
            background: #ff6b6b;
            color: white;
        }

        /* Progress Bar */
        .progress-container {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 3px;
            margin: 10px 0;
        }

        .progress-bar {
            background: linear-gradient(45deg, #00b894, #00cec9);
            height: 10px;
            border-radius: 7px;
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .game-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .game-info {
                justify-content: center;
            }
            
            .character-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .task-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .food-items {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 480px) {
            .character-grid {
                grid-template-columns: 1fr;
            }
            
            .game-header {
                padding: 10px;
            }
            
            .child-character {
                width: 100px;
                height: 100px;
                font-size: 2.5rem;
            }
        }

        /* Accessibility */
        .btn:focus, .task-btn:focus, .food-item:focus {
            outline: 3px solid #ff6b6b;
            outline-offset: 2px;
        }

        .screen-reader-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Level Complete Animation */
        .level-complete {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #00b894, #00cec9);
            color: white;
            padding: 30px;
            border-radius: 20px;
            font-size: 1.5rem;
            text-align: center;
            z-index: 1000;
            animation: levelComplete 2s ease-in-out;
        }

        @keyframes levelComplete {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Audio Controls -->
        <div class="audio-controls">
            <button class="audio-btn" id="musicToggle" title="Toggle Music">üéµ</button>
            <button class="audio-btn" id="soundToggle" title="Toggle Sound Effects">üîä</button>
        </div>

        <!-- Main Menu Screen -->
        <div class="screen active" id="mainMenu">
            <div class="main-menu">
                <h1 class="game-title">üçº Ultimate Babysitting Adventure üß∏</h1>
                <div class="menu-buttons">
                    <button class="btn" onclick="showCharacterSelect()">Start Game</button>
                    <button class="btn" onclick="showInstructions()">Instructions</button>
                    <button class="btn" onclick="showCredits()">Credits</button>
                </div>
            </div>
        </div>

        <!-- Character Selection Screen -->
        <div class="screen" id="characterSelect">
            <div class="character-select">
                <h2 style="color: #ff6b6b; margin-bottom: 20px;">Choose Your Babysitter!</h2>
                <div class="character-grid">
                    <div class="character-card" data-character="0">
                        <div class="character-avatar">üë©‚Äçü¶∞</div>
                        <h3>Emma</h3>
                        <p>The Energetic One</p>
                    </div>
                    <div class="character-card" data-character="1">
                        <div class="character-avatar">üë®‚Äçü¶±</div>
                        <h3>Marcus</h3>
                        <p>The Patient One</p>
                    </div>
                    <div class="character-card" data-character="2">
                        <div class="character-avatar">üë©‚Äçü¶±</div>
                        <h3>Sophia</h3>
                        <p>The Creative One</p>
                    </div>
                    <div class="character-card" data-character="3">
                        <div class="character-avatar">üë®‚Äçü¶≤</div>
                        <h3>Alex</h3>
                        <p>The Caring One</p>
                    </div>
                </div>
                <button class="btn" onclick="startGame()" id="startGameBtn" style="opacity: 0.5;" disabled>Start Adventure!</button>
                <button class="btn" onclick="showMainMenu()" style="background: #ddd; color: #333;">Back</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div class="screen" id="gameScreen">
            <div class="game-screen">
                <div class="game-header">
                    <div class="game-info">
                        <div class="info-item">Level: <span id="levelDisplay">1</span></div>
                        <div class="info-item">Score: <span id="scoreDisplay">0</span></div>
                        <div class="info-item">Time: <span id="timeDisplay">60</span></div>
                    </div>
                    <div>
                        <button class="btn" onclick="pauseGame()" style="padding: 8px 16px; font-size: 0.9rem;">Pause</button>
                        <button class="btn" onclick="showMainMenu()" style="padding: 8px 16px; font-size: 0.9rem; background: #ddd; color: #333;">Quit</button>
                    </div>
                </div>

                <div class="game-area">
                    <div class="child-area">
                        <div class="child-character" id="childCharacter">
                            üë∂
                            <div class="speech-bubble" id="speechBubble" style="display: none;"></div>
                        </div>
                        <div class="child-needs" id="childNeeds">
                            <div class="need-indicator" id="hungerNeed">üçº Hunger: <span>50</span>%</div>
                            <div class="need-indicator" id="happinessNeed">üòä Happiness: <span>50</span>%</div>
                            <div class="need-indicator" id="sleepNeed">üò¥ Sleep: <span>50</span>%</div>
                        </div>
                        <div class="task-buttons">
                            <button class="task-btn" onclick="startFeeding()">Feed Baby</button>
                            <button class="task-btn" onclick="startPlaying()">Play</button>
                            <button class="task-btn" onclick="startSleeping()">Bedtime</button>
                        </div>
                    </div>

                    <!-- Mini-games -->
                    <div class="mini-game hidden" id="feedingGame">
                        <h3>üçº Feeding Time!</h3>
                        <p>Click the right food for the baby!</p>
                        <div class="feeding-game">
                            <div class="food-items" id="foodItems"></div>
                            <div class="drop-zone" id="dropZone">Drop food here!</div>
                            <div id="feedingInstructions">Select the healthy food!</div>
                        </div>
                    </div>

                    <div class="mini-game hidden" id="puzzleGame">
                        <h3>üß© Calm the Baby!</h3>
                        <p>Solve the puzzle to make the baby happy!</p>
                        <div class="puzzle-game">
                            <div class="puzzle-grid" id="puzzleGrid"></div>
                            <div id="puzzleInstructions">Click tiles to swap and complete the pattern!</div>
                        </div>
                    </div>

                    <div class="mini-game hidden" id="catchGame">
                        <h3>üß∏ Catch the Toys!</h3>
                        <p>Move the basket to catch falling toys!</p>
                        <div class="catch-game">
                            <div class="catcher" id="catcher">üß∫</div>
                        </div>
                    </div>
                </div>

                <div class="progress-container">
                    <div class="progress-bar" id="levelProgress" style="width: 0%;"></div>
                </div>
            </div>
        </div>

        <!-- Modals -->
        <div class="modal" id="instructionsModal">
            <div class="modal-content">
                <h2>How to Play</h2>
                <p>üçº <strong>Your Mission:</strong> Take care of the baby and keep them happy!</p>
                <p>üë∂ <strong>Watch the Needs:</strong> Monitor hunger, happiness, and sleep levels.</p>
                <p>üéÆ <strong>Mini-Games:</strong> Complete fun activities to satisfy the baby's needs.</p>
                <p>‚è∞ <strong>Time Management:</strong> Complete tasks before time runs out!</p>
                <p>üìà <strong>Level Up:</strong> Each level gets more challenging with multiple babies!</p>
                <p>üèÜ <strong>Scoring:</strong> Earn points for quick and successful task completion.</p>
                <button class="close-btn" onclick="closeModal('instructionsModal')">Got it!</button>
            </div>
        </div>

        <div class="modal" id="creditsModal">
            <div class="modal-content">
                <h2>Credits</h2>
                <p>üéÆ <strong>Game Design:</strong> Ultimate Babysitting Adventure</p>
                <p>üë©‚Äçüíª <strong>Development:</strong> Claude AI Assistant</p>
                <p>üé® <strong>Graphics:</strong> CSS3 & Unicode Emojis</p>
                <p>üéµ <strong>Audio:</strong> Web Audio API</p>
                <p>üíñ <strong>Made with:</strong> HTML5, CSS3, and JavaScript</p>
                <p>üåü <strong>Special Thanks:</strong> To all the amazing babysitters out there!</p>
                <button class="close-btn" onclick="closeModal('creditsModal')">Close</button>
            </div>
        </div>

        <div class="modal" id="gameOverModal">
            <div class="modal-content">
                <h2 id="gameOverTitle">Game Over</h2>
                <p id="gameOverMessage">Great job babysitting!</p>
                <p>Final Score: <span id="finalScore">0</span></p>
                <p>Levels Completed: <span id="levelsCompleted">0</span></p>
                <button class="btn" onclick="restartGame()">Play Again</button>
                <button class="close-btn" onclick="showMainMenu()">Main Menu</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            currentLevel: 1,
            score: 0,
            timeLeft: 60,
            selectedCharacter: null,
            gameRunning: false,
            gameTimer: null,
            childNeeds: {
                hunger: 50,
                happiness: 50,
                sleep: 50
            },
            currentMiniGame: null,
            levelProgress: 0,
            soundEnabled: true,
            musicEnabled: true
        };

        // Audio Context for sound effects
        let audioContext = null;
        let musicInterval = null;

        // Initialize audio
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        // Play sound effect
        function playSound(frequency, duration = 200, type = 'sine') {
            if (!gameState.soundEnabled || !audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration / 1000);
        }

        // Play success sound
        function playSuccessSound() {
            playSound(523, 100); // C5
            setTimeout(() => playSound(659, 100), 100); // E5
            setTimeout(() => playSound(784, 200), 200); // G5
        }

        // Play failure sound
        function playFailureSound() {
            playSound(220, 500, 'sawtooth'); // Low A
        }

        // Play button click sound
        function playClickSound() {
            playSound(800, 100);
        }

        // Toggle music
        function toggleMusic() {
            gameState.musicEnabled = !gameState.musicEnabled;
            const btn = document.getElementById('musicToggle');
            btn.textContent = gameState.musicEnabled ? 'üéµ' : 'üéµ';
            btn.classList.toggle('muted');
        }

        // Toggle sound effects
        function toggleSound() {
            gameState.soundEnabled = !gameState.soundEnabled;
            const btn = document.getElementById('soundToggle');
            btn.textContent = gameState.soundEnabled ? 'üîä' : 'üîá';
            btn.classList.toggle('muted');
        }

        // Screen management
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showMainMenu() {
            showScreen('mainMenu');
            gameState.gameRunning = false;
            clearInterval(gameState.gameTimer);
        }

        function showCharacterSelect() {
            playClickSound();
            showScreen('characterSelect');
        }

        // Character selection
        function selectCharacter(characterIndex) {
            playClickSound();
            gameState.selectedCharacter = characterIndex;
            
            // Update UI
            document.querySelectorAll('.character-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-character="${characterIndex}"]`).classList.add('selected');
            
            // Enable start button
            const startBtn = document.getElementById('startGameBtn');
            startBtn.disabled = false;
            startBtn.style.opacity = '1';
        }

        // Modal management
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function showInstructions() {
            playClickSound();
            showModal('instructionsModal');
        }

        function showCredits() {
            playClickSound();
            showModal('creditsModal');
        }

        // Game initialization
        function startGame() {
            if (gameState.selectedCharacter === null) return;
            
            playClickSound();
            initAudio();
            
            // Reset game state
            gameState.currentLevel = 1;
            gameState.score = 0;
            gameState.timeLeft = 60;
            gameState.gameRunning = true;
            gameState.levelProgress = 0;
            gameState.childNeeds = {
                hunger: 50,
                happiness: 50,
                sleep: 50
            };
            
            showScreen('gameScreen');
            updateUI();
            startGameTimer();
            generateRandomEvents();
        }

        function restartGame() {
            playClickSound();
            closeModal('gameOverModal');
            startGame();
        }

        function pauseGame() {
            playClickSound();
            gameState.gameRunning = !gameState.gameRunning;
            const pauseBtn = document.querySelector('[onclick="pauseGame()"]');
            pauseBtn.textContent = gameState.gameRunning ? 'Pause' : 'Resume';
            
            if (gameState.gameRunning) {
                startGameTimer();
            } else {
                clearInterval(gameState.gameTimer);
            }
        }

        // Game timer
        function startGameTimer() {
            gameState.gameTimer = setInterval(() => {
                if (!gameState.gameRunning) return;
                
                gameState.timeLeft--;
                updateUI();
                
                // Decrease needs over time
                gameState.childNeeds.hunger = Math.max(0, gameState.childNeeds.hunger - 0.5);
                gameState.childNeeds.happiness = Math.max(0, gameState.childNeeds.happiness - 0.3);
                gameState.childNeeds.sleep = Math.max(0, gameState.childNeeds.sleep - 0.2);
                
                updateNeedsDisplay();
                
                if (gameState.timeLeft <= 0) {
                    endGame();
                }
                
                // Check level completion
                if (gameState.levelProgress >= 100) {
                    levelComplete();
                }
            }, 1000);
        }

        // UI updates
        function updateUI() {
            document.getElementById('levelDisplay').textContent = gameState.currentLevel;
            document.getElementById('scoreDisplay').textContent = gameState.score;
            document.getElementById('timeDisplay').textContent = gameState.timeLeft;
            document.getElementById('levelProgress').style.width = gameState.levelProgress + '%';
        }

        function updateNeedsDisplay() {
            const hungerEl = document.getElementById('hungerNeed');
            const happinessEl = document.getElementById('happinessNeed');
            const sleepEl = document.getElementById('sleepNeed');
            
            hungerEl.querySelector('span').textContent = Math.round(gameState.childNeeds.hunger);
            happinessEl.querySelector('span').textContent = Math.round(gameState.childNeeds.happiness);
            sleepEl.querySelector('span').textContent = Math.round(gameState.childNeeds.sleep);
            
            // Update urgency indicators
            updateNeedUrgency(hungerEl, gameState.childNeeds.hunger);
            updateNeedUrgency(happinessEl, gameState.childNeeds.happiness);
            updateNeedUrgency(sleepEl, gameState.childNeeds.sleep);
        }

        function updateNeedUrgency(element, value) {
            element.classList.remove('urgent', 'satisfied');
            if (value < 30) {
                element.classList.add('urgent');
            } else if (value > 80) {
                element.classList.add('satisfied');
            }
        }

        // Mini-games
        function startFeeding() {
            playClickSound();
            if (gameState.currentMiniGame) return;
            
            gameState.currentMiniGame = 'feeding';
            showMiniGame('feedingGame');
            initFeedingGame();
        }

        function startPlaying() {
            playClickSound();
            if (gameState.currentMiniGame) return;
            
            gameState.currentMiniGame = 'puzzle';
            showMiniGame('puzzleGame');
            initPuzzleGame();
        }

        function startSleeping() {
            playClickSound();
            if (gameState.currentMiniGame) return;
            
            gameState.currentMiniGame = 'catch';
            showMiniGame('catchGame');
            initCatchGame();
        }

        function showMiniGame(gameId) {
            document.querySelectorAll('.mini-game').forEach(game => {
                game.classList.add('hidden');
            });
            document.getElementById(gameId).classList.remove('hidden');
        }

        function hideMiniGame() {
            document.querySelectorAll('.mini-game').forEach(game => {
                game.classList.add('hidden');
            });
            gameState.currentMiniGame = null;
        }

        // Feeding Game
        function initFeedingGame() {
            const foods = ['üçº', 'üçé', 'ü•ï', 'üç≠', 'üç™', 'ü•§'];
            const healthyFoods = ['üçº', 'üçé', 'ü•ï'];
            const currentFood = healthyFoods[Math.floor(Math.random() * healthyFoods.length)];
            
            const foodContainer = document.getElementById('foodItems');
            const dropZone = document.getElementById('dropZone');
            const instructions = document.getElementById('feedingInstructions');
            
            foodContainer.innerHTML = '';
            instructions.textContent = `Find the ${currentFood} for the baby!`;
            
            // Shuffle foods
            const shuffledFoods = [...foods].sort(() => Math.random() - 0.5);
            
            shuffledFoods.forEach(food => {
                const foodItem = document.createElement('div');
                foodItem.className = 'food-item';
                foodItem.textContent = food;
                foodItem.onclick = () => selectFood(food, currentFood);
                foodContainer.appendChild(foodItem);
            });
        }

        function selectFood(selectedFood, correctFood) {
            playClickSound();
            
            if (selectedFood === correctFood) {
                playSuccessSound();
                gameState.childNeeds.hunger = Math.min(100, gameState.childNeeds.hunger + 30);
                gameState.score += 50;
                gameState.levelProgress += 25;
                showSpeechBubble('Yummy! Thank you!');
                setTimeout(hideMiniGame, 1500);
            } else {
                playFailureSound();
                gameState.childNeeds.happiness = Math.max(0, gameState.childNeeds.happiness - 10);
                showSpeechBubble('That\'s not what I want!');
                setTimeout(hideMiniGame, 1500);
            }
            
            updateUI();
            updateNeedsDisplay();
        }

        // Puzzle Game
        function initPuzzleGame() {
            const puzzleGrid = document.getElementById('puzzleGrid');
            const colors = ['üî¥', 'üü°', 'üü¢', 'üîµ', 'üü£', 'üü†', '‚ö´', '‚ö™', ''];
            
            puzzleGrid.innerHTML = '';
            
            // Create 3x3 grid with one empty space
            for (let i = 0; i < 9; i++) {
                const piece = document.createElement('div');
                piece.className = 'puzzle-piece';
                piece.textContent = colors[i];
                piece.onclick = () => movePuzzlePiece(i);
                
                if (i === 8) {
                    piece.classList.add('empty');
                }
                
                puzzleGrid.appendChild(piece);
            }
            
            // Shuffle the puzzle
            shufflePuzzle();
        }

        function shufflePuzzle() {
            const pieces = document.querySelectorAll('.puzzle-piece');
            const contents = Array.from(pieces).map(p => p.textContent);
            
            // Simple shuffle
            for (let i = contents.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [contents[i], contents[j]] = [contents[j], contents[i]];
            }
            
            pieces.forEach((piece, index) => {
                piece.textContent = contents[index];
                piece.classList.toggle('empty', contents[index] === '');
            });
        }

        function movePuzzlePiece(index) {
            playClickSound();
            const pieces = document.querySelectorAll('.puzzle-piece');
            const emptyIndex = Array.from(pieces).findIndex(p => p.classList.contains('empty'));
            
            // Check if move is valid (adjacent to empty space)
            const validMoves = [
                emptyIndex - 1, emptyIndex + 1, // horizontal
                emptyIndex - 3, emptyIndex + 3  // vertical
            ].filter(i => i >= 0 && i < 9);
            
            if (validMoves.includes(index)) {
                // Swap pieces
                const temp = pieces[index].textContent;
                pieces[index].textContent = pieces[emptyIndex].textContent;
                pieces[emptyIndex].textContent = temp;
                
                pieces[index].classList.toggle('empty');
                pieces[emptyIndex].classList.toggle('empty');
                
                // Check if puzzle is solved
                if (checkPuzzleSolved()) {
                    setTimeout(() => {
                        playSuccessSound();
                        gameState.childNeeds.happiness = Math.min(100, gameState.childNeeds.happiness + 25);
                        gameState.score += 75;
                        gameState.levelProgress += 30;
                        showSpeechBubble('Wow! Pretty colors!');
                        setTimeout(hideMiniGame, 1500);
                        updateUI();
                        updateNeedsDisplay();
                    }, 500);
                }
            }
        }

        function checkPuzzleSolved() {
            const pieces = document.querySelectorAll('.puzzle-piece');
            const expected = ['üî¥', 'üü°', 'üü¢', 'üîµ', 'üü£', 'üü†', '‚ö´', '‚ö™', ''];
            
            return Array.from(pieces).every((piece, index) => {
                return piece.textContent === expected[index];
            });
        }

        // Catch Game
        function initCatchGame() {
            const catchArea = document.getElementById('catchGame');
            const catcher = document.getElementById('catcher');
            let catcherPosition = 50; // percentage
            let score = 0;
            let toysToyCatch = 5;
            let toysCaught = 0;
            let gameTime = 10;
            
            // Reset catcher position
            catcher.style.left = '50%';
            
            // Add mouse/touch controls
            const gameArea = catcher.parentElement;
            gameArea.onmousemove = (e) => {
                const rect = gameArea.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const percentage = (x / rect.width) * 100;
                catcher.style.left = Math.max(5, Math.min(95, percentage)) + '%';
            };
            
            gameArea.ontouchmove = (e) => {
                e.preventDefault();
                const rect = gameArea.getBoundingClientRect();
                const x = e.touches[0].clientX - rect.left;
                const percentage = (x / rect.width) * 100;
                catcher.style.left = Math.max(5, Math.min(95, percentage)) + '%';
            };
            
            // Start dropping toys
            const dropInterval = setInterval(() => {
                if (toysCaught >= toysToyCatch || gameTime <= 0) {
                    clearInterval(dropInterval);
                    endCatchGame(toysCaught >= toysToyCatch);
                    return;
                }
                
                dropToy();
                gameTime--;
            }, 1000);
        }

        function dropToy() {
            const toys = ['üß∏', 'üéæ', 'ü™Ä', 'üéØ', 'üß©'];
            const toy = document.createElement('div');
            toy.className = 'falling-toy';
            toy.textContent = toys[Math.floor(Math.random() * toys.length)];
            toy.style.left = Math.random() * 80 + 10 + '%';
            toy.style.animationDuration = (Math.random() * 2 + 3) + 's';
            
            document.getElementById('catchGame').appendChild(toy);
            
            // Check for collision
            const checkCollision = setInterval(() => {
                const toyRect = toy.getBoundingClientRect();
                const catcherRect = document.getElementById('catcher').getBoundingClientRect();
                
                if (toyRect.bottom >= catcherRect.top &&
                    toyRect.left < catcherRect.right &&
                    toyRect.right > catcherRect.left) {
                    
                    // Caught!
                    playSuccessSound();
                    toy.remove();
                    clearInterval(checkCollision);
                    
                    // Update catch count
                    let caught = parseInt(toy.parentElement?.dataset.caught || '0') + 1;
                    if (toy.parentElement) {
                        toy.parentElement.dataset.caught = caught;
                    }
                }
            }, 50);
            
            // Remove toy after animation
            setTimeout(() => {
                if (toy.parentElement) {
                    toy.remove();
                    clearInterval(checkCollision);
                }
            }, 5000);
        }

        function endCatchGame(success) {
            if (success) {
                playSuccessSound();
                gameState.childNeeds.sleep = Math.min(100, gameState.childNeeds.sleep + 20);
                gameState.childNeeds.happiness = Math.min(100, gameState.childNeeds.happiness + 15);
                gameState.score += 100;
                gameState.levelProgress += 35;
                showSpeechBubble('So sleepy now... zzz');
            } else {
                playFailureSound();
                gameState.childNeeds.happiness = Math.max(0, gameState.childNeeds.happiness - 5);
                showSpeechBubble('I wanted to play more!');
            }
            
            // Clean up
            document.querySelectorAll('.falling-toy').forEach(toy => toy.remove());
            
            setTimeout(hideMiniGame, 2000);
            updateUI();
            updateNeedsDisplay();
        }

        // Speech bubble
        function showSpeechBubble(message) {
            const bubble = document.getElementById('speechBubble');
            bubble.textContent = message;
            bubble.style.display = 'block';
            
            setTimeout(() => {
                bubble.style.display = 'none';
            }, 3000);
        }

        // Random events
        function generateRandomEvents() {
            if (!gameState.gameRunning) return;
            
            const events = [
                () => {
                    showSpeechBubble('I\'m getting hungry!');
                    gameState.childNeeds.hunger = Math.max(0, gameState.childNeeds.hunger - 10);
                },
                () => {
                    showSpeechBubble('Let\'s play!');
                    gameState.childNeeds.happiness = Math.max(0, gameState.childNeeds.happiness - 5);
                },
                () => {
                    showSpeechBubble('I\'m getting sleepy...');
                    gameState.childNeeds.sleep = Math.max(0, gameState.childNeeds.sleep - 8);
                },
                () => {
                    showSpeechBubble('You\'re the best babysitter!');
                    gameState.score += 10;
                }
            ];
            
            // Random event every 15-30 seconds
            setTimeout(() => {
                if (gameState.gameRunning) {
                    const randomEvent = events[Math.floor(Math.random() * events.length)];
                    randomEvent();
                    updateNeedsDisplay();
                    updateUI();
                    generateRandomEvents();
                }
            }, Math.random() * 15000 + 15000);
        }

        // Level progression
        function levelComplete() {
            playSuccessSound();
            gameState.currentLevel++;
            gameState.timeLeft += 30; // Bonus time
            gameState.levelProgress = 0;
            
            // Show level complete animation
            const levelCompleteDiv = document.createElement('div');
            levelCompleteDiv.className = 'level-complete';
            levelCompleteDiv.innerHTML = `
                <div>üéâ Level ${gameState.currentLevel - 1} Complete! üéâ</div>
                <div>Bonus: +30 seconds</div>
                <div>Starting Level ${gameState.currentLevel}</div>
            `;
            document.body.appendChild(levelCompleteDiv);
            
            setTimeout(() => {
                levelCompleteDiv.remove();
            }, 3000);
            
            // Increase difficulty
            if (gameState.currentLevel % 3 === 0) {
                // Add second baby every 3 levels
                addSecondBaby();
            }
            
            updateUI();
        }

        function addSecondBaby() {
            const childArea = document.querySelector('.child-area');
            const secondBaby = document.createElement('div');
            secondBaby.className = 'child-character';
            secondBaby.innerHTML = 'üë∂';
            secondBaby.style.marginLeft = '20px';
            
            childArea.appendChild(secondBaby);
            showSpeechBubble('Look! A friend came to play!');
        }

        // Game over
        function endGame() {
            gameState.gameRunning = false;
            clearInterval(gameState.gameTimer);
            
            // Calculate final score
            const timeBonus = gameState.timeLeft > 0 ? gameState.timeLeft * 5 : 0;
            const needsBonus = (gameState.childNeeds.hunger + gameState.childNeeds.happiness + gameState.childNeeds.sleep) / 3;
            const finalScore = gameState.score + timeBonus + Math.round(needsBonus);
            
            // Save high score
            const highScore = localStorage.getItem('babysittingHighScore') || 0;
            if (finalScore > highScore) {
                localStorage.setItem('babysittingHighScore', finalScore);
            }
            
            // Show game over modal
            document.getElementById('gameOverTitle').textContent = 
                gameState.timeLeft > 0 ? 'Congratulations!' : 'Time\'s Up!';
            document.getElementById('gameOverMessage').textContent = 
                gameState.timeLeft > 0 ? 'You did an amazing job babysitting!' : 'Better luck next time!';
            document.getElementById('finalScore').textContent = finalScore;
            document.getElementById('levelsCompleted').textContent = gameState.currentLevel - 1;
            
            showModal('gameOverModal');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Character selection
            document.querySelectorAll('.character-card').forEach((card, index) => {
                card.onclick = () => selectCharacter(index);
            });
            
            // Audio controls
            document.getElementById('musicToggle').onclick = toggleMusic;
            document.getElementById('soundToggle').onclick = toggleSound;
            
            // Keyboard controls
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (gameState.gameRunning) {
                        pauseGame();
                    } else {
                        showMainMenu();
                    }
                }
                
                if (e.key === 'r' || e.key === 'R') {
                    if (!gameState.gameRunning) {
                        restartGame();
                    }
                }
            });
            
            // Prevent context menu on mobile
            document.addEventListener('contextmenu', (e) => {
                e.preventDefault();
            });
            
            // Initialize with main menu
            showMainMenu();
        });

        // Mobile touch improvements
        document.addEventListener('touchstart', (e) => {
            if (e.target.classList.contains('btn') || e.target.classList.contains('task-btn')) {
                e.target.style.transform = 'scale(0.95)';
            }
        });

        document.addEventListener('touchend', (e) => {
            if (e.target.classList.contains('btn') || e.target.classList.contains('task-btn')) {
                e.target.style.transform = '';
            }
        });

        // Accessibility improvements
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                if (e.target.classList.contains('btn') || 
                    e.target.classList.contains('task-btn') ||
                    e.target.classList.contains('character-card')) {
                    e.target.click();
                    e.preventDefault();
                }
            }
        });

        // Make elements focusable for keyboard navigation
        document.querySelectorAll('.character-card, .food-item, .puzzle-piece').forEach(el => {
            el.setAttribute('tabindex', '0');
        });
    </script>
</body>
</html>
